#!/bin/bash

#Inherits environment from runner
p7zip="$sevenZip";
echo "my 7zip location is $my7zip";
IFS=$'\n';
#get the rom names.  -slt flag to p7zip seems to print them out in most usable fashion
romNames=($($p7zip l -slt "$my7zip" | grep "Path =" | sed -e 's/^[Path = ]*//g'));
unset IFS;
numGoodDumps=${#romNames[@]}; ##TODO: its not - need to be explicit about 7zip option
echo "Number of dumps is $numGoodDumps";

PS3="Please enter the number of the rom you wish to play (or 0 to abort): "; #TODO zero to abort?
select choice in "${romNames[@]}"; do
	if [[ $REPLY>0 && $REPLY<$numGoodDumps+1 ]]; then #todo its not +1....
		echo "you chose $choice";
		rom=${romNames[$REPLY-1]};			
		break;
	fi;
	if [[ $REPLY<=0 ]]; then exit; fi;
	echo "Invalid Option Please choose again";
done;

$p7zip e -y -o"$tempDir" "$my7zip" "$rom"; #TODO: if something goes wrong here, it extracts ALL files....
export pathToRom="$tempDir/$rom";





